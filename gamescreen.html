<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-02-05T21:58:43.521437519"><title>Game Screen | Fantasy-Chess Documentation</title><script type="application/json" id="virtual-toc-data">[{"id":"creation","level":0,"title":"Creation","anchor":"#creation"},{"id":"inputs","level":0,"title":"Inputs","anchor":"#inputs"},{"id":"game-phases","level":0,"title":"Game Phases","anchor":"#game-phases"},{"id":"map-rendering","level":0,"title":"Map Rendering","anchor":"#map-rendering"},{"id":"other-layers","level":0,"title":"Other Layers","anchor":"#other-layers"},{"id":"ui-elements","level":0,"title":"UI Elements","anchor":"#ui-elements"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b575/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Game Screen | Fantasy-Chess Documentation"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Fantasy-Chess Documentation Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/gamescreen.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Game Screen | Fantasy-Chess Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/gamescreen.html#webpage",
    "url": "writerside-documentation/gamescreen.html",
    "name": "Game Screen | Fantasy-Chess Documentation",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Fantasy-Chess Documentation Help"
}</script><!-- End Schema.org --></head><body data-id="GameScreen" data-main-title="Game Screen" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="Technical Reference///Client///Screens.md|Screens"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Fantasy-Chess Documentation  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="GameScreen" id="GameScreen.md">Game Screen</h1><p id="-irw8w9_3"><code class="code" id="-irw8w9_13">Author: Lukas Walker</code></p><figure id="-irw8w9_4"><img alt="Game screen command" src="images/GameScreenCommand.png" title="Game screen command" width="3839" height="2159"></figure><p id="-irw8w9_5">The Game Screen is the main screen of the game. All gameplay happens here.</p><p id="-irw8w9_6">See <a href="screens.html" id="-irw8w9_14" data-tooltip="Screens are the different scenes we can see in the game. This game relies on three screens:">Screens</a> for general screen implementation methods and details.</p><section class="chapter"><h2 id="creation" data-toc="creation">Creation</h2><p id="-irw8w9_15">The following things happen when the game screen gets created (combination of constructor and show methods):</p><ul class="list _bullet" id="-irw8w9_16"><li class="list__item" id="-irw8w9_18"><p>Creation of cameras and viewports for rendering</p></li><li class="list__item" id="-irw8w9_19"><p>Creating of font for displaying damage numbers</p></li><li class="list__item" id="-irw8w9_20"><p>Creation of important ui elements like the <a href="#ready-button" id="-irw8w9_27" data-tooltip="The ready button lets the players send their commands. Its text gives some hints about the current state of the game, displaying the amount of commands set in the current round or tells the player to wait for his opponent. The button is updated using his act(float delta) method…">readyButton</a></p></li><li class="list__item" id="-irw8w9_21"><p>Creation of the <a href="https://libgdx.com/wiki/tools/texture-packer" id="-irw8w9_28" data-external="true" rel="noopener noreferrer">atlas</a> for texture retrieval and <a href="https://libgdx.com/wiki/graphics/2d/spritebatch-textureregions-and-sprites" id="-irw8w9_29" data-external="true" rel="noopener noreferrer">batch</a> for sprite rendering</p></li><li class="list__item" id="-irw8w9_22"><p>Import of the tiled tmx map used for rendering the map + creation of its renderer</p></li><li class="list__item" id="-irw8w9_23"><p>Creation of the <code class="code" id="-irw8w9_30">TiledMathService</code> for all calculations. See <a href="tilemap.html" id="-irw8w9_31" data-tooltip="Author: Jacinto Schwarzwälder">Tilemap</a></p></li><li class="list__item" id="-irw8w9_24"><p>Creation of custom map layers. See <a href="#other-layers" id="-irw8w9_32" data-tooltip="All information about the status of tiles or the possibility or effect of certain commands is delivered using visual clues. Most of these are implemented using custom layers in the TiledMap using TiledMapTileLayers. By creating these layers, configuring their tiles to display…">Other Layers</a></p></li><li class="list__item" id="-irw8w9_25"><p>Registration of input processors. See <a href="mapinputadapter.html" id="-irw8w9_33" data-tooltip="Author: Lukas Walker">Map Input Adapter</a></p></li><li class="list__item" id="-irw8w9_26"><p>Registration of event and packet handlers used for game state networking. See <a href="networking.html#websocket-service" id="-irw8w9_34" data-tooltip="Forms the backbone of the clientside networking, managing packet routing and client authentication. To facilitate routing, the service makes use of the PacketHandler functional interface, which allows inline or outside declaration of handlers.">WebSocket Service</a></p></li></ul><p id="-irw8w9_17">The two stat panels are created later on in the <a href="#game-initialisation" id="-irw8w9_35" data-tooltip="Entering the Game Initialisation Phase brings the game to life. This process gets initiated by receiving the GAME_INIT packet, which calls the initializeGame method.">Game Initialisation</a>. See <a href="#stat-panels" id="-irw8w9_36" data-tooltip="The stat panels are the two large panels on the top sides of the screen. They display the current status of all characters currently alive on the board. The hp bars are colored according to their current hp. Clicking on a character opens a Dialog that displays all information about…">Stat Panels</a> for information about them.</p></section><section class="chapter"><h2 id="inputs" data-toc="inputs">Inputs</h2><p id="-irw8w9_37">The inputs in this screen are processed using a <code class="code" id="-irw8w9_40">InputMultiplexer</code> that stacks multiple input processors on top of each other. The processors receive the InputEvent in the order they were added and if a processor returns <code class="code" id="-irw8w9_41">true</code>, the Event is regarded as handled.</p><div class="code-block" data-lang="java">
InputMultiplexer multiplexer = new InputMultiplexer();
multiplexer.addProcessor(new FullscreenInputListener());
multiplexer.addProcessor(stage);
multiplexer.addProcessor(mapInputProcessor);
</div><p id="-irw8w9_39">See <a href="input.html" id="-irw8w9_42" data-tooltip="Author: Lukas Walker">Input</a> about general information about input processing. The mapInputProcessor contains the logic for interacting with the playing field itself. See <a href="mapinputadapter.html" id="-irw8w9_43" data-tooltip="Author: Lukas Walker">Map Input Adapter</a> or its <a href="https://b-team-organisation.github.io/Fantasy-Chess/java-docs/client/core/com/bteam/fantasychess_client/input/MapInputAdapter.html" id="-irw8w9_44" data-external="true" rel="noopener noreferrer">javadoc</a> for more information</p></section><section class="chapter"><h2 id="game-phases" data-toc="game-phases">Game Phases</h2><p id="-irw8w9_45">The entire time a players game shows the Game Screen, it is in some kind of phase. These phases represent the current context of the game screen and are used to regulate the flow of the game and contextualize inputs.</p><p id="-irw8w9_46">The following diagram visualises the states and transitions:</p><figure id="-irw8w9_47"><img alt="Complex cycle" src="images/ComplexCycle.svg" title="Complex cycle" width="856" height="348"></figure><p id="-irw8w9_48">The states are saved in the <code class="code" id="-irw8w9_56">MapInputAdapter</code> which is where most calls referencing this state are happening.</p><p id="-irw8w9_49">When creating a lobby in the <a href="mainmenu.html" id="-irw8w9_57" data-tooltip="Author: Lukas Walker">Main Menu</a>, the game <a href="screens.html#screen-manager" id="-irw8w9_58" data-tooltip="The Screen Manager can be used to navigate between screens by calling the navigateTo(Screens screen) method. This method capsules a call to navigateToNonRunnable(Screens screen) to increase readability, as not doing so would require posting a Runnable to the LibGDX Thread:">navigates</a> to the Game Screen. This puts the Game Screen in the <a href="#lobby-phase" id="-irw8w9_59" data-tooltip="The lobby phase starts when the screen is created and ends when the game starts. Both players have to be ready at this point. They can set themselfs ready using the provided dialog, leading to their status being communicated with the other client via the server. Leaving the lobby…">Lobby Phase</a> by default.</p><section class="chapter"><h3 id="lobby-phase" data-toc="lobby-phase">Lobby Phase</h3><p id="-irw8w9_60">The lobby phase starts when the screen is created and ends when the game starts. Both players have to be ready at this point. They can set themselfs ready using the provided dialog, leading to their status being communicated with the other client via the server. Leaving the lobby phase puts the screen into the <a href="#game-initialisation" id="-irw8w9_61" data-tooltip="Entering the Game Initialisation Phase brings the game to life. This process gets initiated by receiving the GAME_INIT packet, which calls the initializeGame method.">Game Initialisation Phase</a>.</p></section><section class="chapter"><h3 id="game-initialisation" data-toc="game-initialisation">Game Initialisation</h3><figure id="-irw8w9_62"><img alt="Game screen init" src="images/GameScreenInit.png" title="Game screen init" width="3839" height="2159"></figure><p id="-irw8w9_63">Entering the Game Initialisation Phase brings the game to life. This process gets initiated by receiving the <code class="code" id="-irw8w9_69">GAME_INIT</code> packet, which calls the <code class="code" id="-irw8w9_70">initializeGame</code> method.</p><div class="code-block" data-lang="java">
getWebSocketService().addPacketHandler(&quot;GAME_INIT&quot;,
    str -&gt; Gdx.app.postRunnable(() -&gt; {
        getGameStateService().registerNewGame(9, 9);
        var characters = CharacterEntityMapper.fromListDTO(str);
        String gameId = new JsonReader().parse(str)
            .get(&quot;data&quot;).getString(&quot;gameId&quot;);
        getGameStateService().setGameId(gameId);
        getGameStateService().setCharacters(characters);
        initializeGame();
}));
</div><p id="-irw8w9_65">This method updates the current phase in the <a href="mapinputadapter.html" id="-irw8w9_71" data-tooltip="Author: Lukas Walker">Map Input Adapter</a>, handels the configuration and presentation of the start tiles (See green area on the image) of the <a href="gridmodel.html" id="-irw8w9_72" data-tooltip="Author: Lukas Walker">Grid Model</a> and creates the <a href="charactersprite.html" id="-irw8w9_73" data-tooltip="Author: Lukas Walker">Character Sprites</a> for all <a href="characterentity.html" id="-irw8w9_74" data-tooltip="Character Entities">Character Entities</a>. This is also when the <a href="#stat-panels" id="-irw8w9_75" data-tooltip="The stat panels are the two large panels on the top sides of the screen. They display the current status of all characters currently alive on the board. The hp bars are colored according to their current hp. Clicking on a character opens a Dialog that displays all information about…">Stat Panels</a> are created.</p><p id="-irw8w9_66">In this phase, the players are able to position their characters however they want. Their final placement is shown to the other player only after both players logged in their positions.</p><p id="-irw8w9_67">For more information about this, see <a href="mapinputadapter.html#process-click-in-game-init-mode" id="-irw8w9_76" data-tooltip="This method is called if the click hits a tile in the .">here</a>.</p><p id="-irw8w9_68">When the player logs in his choice using the <a href="#ready-button" id="-irw8w9_77" data-tooltip="The ready button lets the players send their commands. Its text gives some hints about the current state of the game, displaying the amount of commands set in the current round or tells the player to wait for his opponent. The button is updated using his act(float delta) method…">Ready Button</a>, the screen will be put into the <code class="code" id="-irw8w9_78">Waiting for Turn Outcome</code> Phase.</p></section><section class="chapter"><h3 id="waiting-for-turn-outcome" data-toc="waiting-for-turn-outcome">Waiting for Turn Outcome</h3><p id="-irw8w9_79">This phase describes the phase between sending the commands and receiving a response from the server. As soon as the <a href="turn-logic.html" id="-irw8w9_80" data-tooltip="Author: Jacinto Schwarzwälder">TurnResult</a> arrives, the screen starts the <code class="code" id="-irw8w9_81">Turn Outcome Animation</code>.</p></section><section class="chapter"><h3 id="turn-outcome-animation" data-toc="turn-outcome-animation">Turn Outcome Animation</h3><p id="-irw8w9_82">This phase is responsible for displaying the turn outcome animation. See <a href="turnoutcomeanimations.html" id="-irw8w9_83" data-tooltip="Author: Lukas Walker">Turn Outcome Animation</a>. As soon as the animation is over, the screen enter the Command Phase or Game Summary Phase (if a winner or draw was communicated by the server).</p></section><section class="chapter"><h3 id="command-phase" data-toc="command-phase">Command Phase</h3><figure id="-irw8w9_84"><img alt="Command mode commands" src="images/CommandModeCommands.png" title="Command mode commands" width="3840" height="2160"></figure><p id="-irw8w9_85">This is the phase the player will spend most time in. All commands are planed and chosen here.</p></section><section class="chapter"><h3 id="game-summary" data-toc="game-summary">Game Summary</h3><p id="-irw8w9_86">This phase is the last phase of the game loop. Its shows both players the winner of the game in a <code class="code" id="-irw8w9_87">Dialog</code>.</p></section></section><section class="chapter"><h2 id="map-rendering" data-toc="map-rendering">Map Rendering</h2><p id="-irw8w9_88">The map was created using the tool <a href="http://www.mapeditor.org/" id="-irw8w9_89" data-external="true" rel="noopener noreferrer">Tiled</a> and exported as a tmx file. This file can be loaded using the TmxMapLoader to directly manipulate and render it in game. The map itself is stored in the base layer of this map, every single tile being saved with all necessary information for its depiction.</p></section><section class="chapter"><h2 id="other-layers" data-toc="other-layers">Other Layers</h2><p id="-irw8w9_90">All information about the status of tiles or the possibility or effect of certain commands is delivered using visual clues. Most of these are implemented using custom layers in the <code class="code" id="-irw8w9_96">TiledMap</code> using <code class="code" id="-irw8w9_97">TiledMapTileLayers</code>. By creating these layers, configuring their tiles to display certain textures and adding them to the tiled map object, they can be rendered to the screen.</p><p id="-irw8w9_91">The following custom layers are used in the game:</p><section class="chapter"><h3 id="start-rows-layer" data-toc="start-rows-layer">Start-Rows Layer</h3><figure id="-irw8w9_98"><img alt="Start tiles layer" src="images/StartTilesLayer.png" title="Start tiles layer" width="1773" height="903"></figure><p id="-irw8w9_99">This layers contains the transparent green tiles seen in the <a href="#game-initialisation" id="-irw8w9_100" data-tooltip="Entering the Game Initialisation Phase brings the game to life. This process gets initiated by receiving the GAME_INIT packet, which calls the initializeGame method.">Game Initialisation</a>. It shows the player the area in which the player can move or swap his characters during the phase.</p></section><section class="chapter"><h3 id="selected-character-layer" data-toc="selected-character-layer">Selected-Character Layer</h3><figure id="-irw8w9_101"><img alt="Selected character" src="images/SelectedCharacter.png" title="Selected character" width="332" height="232"></figure><p id="-irw8w9_102">This layers contains a single green tile to show which character is currently selected when giving commands.</p></section><section class="chapter"><h3 id="highlight-layer" data-toc="highlight-layer">Highlight Layer</h3><figure id="-irw8w9_103"><img alt="Highlight layer" src="images/HighlightLayer.png" title="Highlight layer" width="534" height="296"></figure><p id="-irw8w9_104">This layer contains a highlight on the tile currently hovered by the player.</p></section><section class="chapter"><h3 id="command-option-preview-layer" data-toc="command-option-preview-layer">Command Option/Preview Layer</h3><figure id="-irw8w9_105"><img alt="Move preview" src="images/MovePreview.png" title="Move preview" width="400" height="215"></figure><figure id="-irw8w9_106"><img alt="Attack preview" src="images/AttackPreview.png" title="Attack preview" width="400" height="211"></figure><p id="-irw8w9_107">The command option layer depicts all valid target tiles of an attack/movement command. In the images, it is responsible for the yellow circles (movement options) and red squares (attack options).</p><p id="-irw8w9_108">The command preview layer visualizes the result of a command. Its responsible for all filled out tiles in yellow (movement) and red (attack area).</p></section></section><section class="chapter"><h2 id="ui-elements" data-toc="ui-elements">UI Elements</h2><p id="-irw8w9_109">The Game Screen features many UI elements, each providing valuable functions to the player.</p><section class="chapter"><h3 id="ready-button" data-toc="ready-button">Ready Button</h3><p id="-irw8w9_113">The ready button lets the players send their commands. Its text gives some hints about the current state of the game, displaying the amount of commands set in the current round or tells the player to wait for his opponent. The button is updated using his <code class="code" id="-irw8w9_114">act(float delta)</code> method that's called together with <code class="code" id="-irw8w9_115">stage.act()</code> in the rendering method and in situations where it should not be pressed.</p></section><section class="chapter"><h3 id="stat-panels" data-toc="stat-panels">Stat Panels</h3><p id="-irw8w9_116">The stat panels are the two large panels on the top sides of the screen. They display the current status of all characters currently alive on the board. The hp bars are colored according to their current hp. Clicking on a character opens a <code class="code" id="-irw8w9_117">Dialog</code> that displays all information about the character.</p></section><section class="chapter"><h3 id="escape-menu" data-toc="escape-menu">Escape menu</h3><p id="-irw8w9_118">A small menu that opens thanks to the <a href="mapinputadapter.html" id="-irw8w9_119" data-tooltip="Author: Lukas Walker">Map Input Adapter</a> that allows the player to abandon the match and return to the main menu.</p></section></section><div class="last-modified">Last modified: 05 February 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="mainmenu.html" class="navigation-links__prev">Main Menu</a><a href="input.html" class="navigation-links__next">Input</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b575/app.js"></script></body></html>